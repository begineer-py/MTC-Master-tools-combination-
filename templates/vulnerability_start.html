{% extends "base.html" %}
{% block content %}
<div class="vulnerability-container">
    <h1>漏洞掃描</h1>
    
    <div class="target-info">
        <h2>目標信息</h2>
        <p>目標 IP: {{ target.target_ip }}</p>
        <p>目標 URL: {{ target.target_ip_no_https }}</p>
        <p>目標端口: {{ target.target_port }}</p>
    </div>

    <div class="scan-controls">
        <div class="scan-section">
            <h2>SQL 注入掃描</h2>
            <button class="sql-injection-scan-btn" 
                    data-user-id="{{ current_user.id }}" 
                    data-target-id="{{ target.id }}"
                    data-target-url="{{ target.target_ip }}">
                開始 SQL 注入掃描
            </button>
            <div id="sql-injection-status-{{ target.id }}" class="scan-status"></div>
            <div id="sql-injection-result-{{ target.id }}" class="scan-result"></div>
        </div>
    </div>

    <style>
        .vulnerability-container {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .target-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .scan-section {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .scan-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .scan-button:hover {
            background-color: #0056b3;
        }
        .scan-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .scan-status, .scan-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .text-success {
            color: #28a745;
        }
        .text-danger {
            color: #dc3545;
        }
    </style>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/vulnerability_start_sql.js') }}"></script>
{% endblock %}
