from flask import Blueprint, request, jsonify
from vulnerability_scanning.threads.threads_xss import XSSThread
from flask_login import login_required, current_user
from instance.models import Target
from utils.permission import check_user_permission
xss_blueprint = Blueprint('xss', __name__)

@xss_blueprint.route('/scan/<int:user_id>/<int:target_id>', methods=['POST','GET'])
@login_required
def xss_scan(user_id, target_id):
    xss_thread = XSSThread(user_id, target_id)
    xss_thread.start()
    return jsonify({'message': 'XSS 掃描開始'})

@xss_blueprint.route('/result/<int:user_id>/<int:target_id>', methods=['POST'])
@login_required
def xss_result(user_id, target_id):
    xss_thread = XSSThread(user_id, target_id)
    xss_thread.start()
    return jsonify({'message': 'XSS 掃描結果'})
@xss_blueprint.route('/download/<int:user_id>/<int:target_id>', methods=['GET'])
@login_required
def xss_download(user_id, target_id):
    pass
